{"ast":null,"code":"import { jwtDecode } from 'jwt-decode';\nexport const setToken = token => {\n  localStorage.setItem('token', token);\n};\nexport const getToken = () => {\n  return localStorage.getItem('token');\n};\nexport const removeToken = () => {\n  localStorage.removeItem('token');\n};\nexport const isAuthenticated = () => {\n  const token = getToken();\n  return token !== null;\n};\nexport const getCurrentUser = async () => {\n  const res = await fetch('http://localhost:5000/api/auth/current', {\n    method: 'GET',\n    credentials: 'include' // <-- This is crucial!\n  });\n  if (!res.ok) return null;\n  return await res.json();\n};\nexport const loginUser = async ({\n  username,\n  password\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/login', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  const data = await response.json();\n  if (data.token) {\n    setToken(data.token);\n    return await getCurrentUser();\n  } else {\n    throw new Error(data.message || 'Login failed');\n  }\n};\nexport const registerUser = async ({\n  username,\n  password,\n  role\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/register', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password,\n      role\n    })\n  });\n  const data = await response.json();\n  if (response.ok) {\n    return data;\n  } else {\n    throw new Error(data.message || 'Registration failed');\n  }\n};\nexport const logoutUser = () => {\n  removeToken();\n};","map":{"version":3,"names":["jwtDecode","setToken","token","localStorage","setItem","getToken","getItem","removeToken","removeItem","isAuthenticated","getCurrentUser","res","fetch","method","credentials","ok","json","loginUser","username","password","response","headers","body","JSON","stringify","data","Error","message","registerUser","role","logoutUser"],"sources":["C:/Users/Mansa Pandey/Desktop/SampleProject/unified-security-app/frontend/src/utils/authUtils.js"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\n\nexport const setToken = (token) => {\n    localStorage.setItem('token', token);\n};\n\nexport const getToken = () => {\n    return localStorage.getItem('token');\n};\n\nexport const removeToken = () => {\n    localStorage.removeItem('token');\n};\n\nexport const isAuthenticated = () => {\n    const token = getToken();\n    return token !== null;\n};\n\nexport const getCurrentUser = async () => {\n    const res = await fetch('http://localhost:5000/api/auth/current', {\n        method: 'GET',\n        credentials: 'include', // <-- This is crucial!\n    });\n    if (!res.ok) return null;\n    return await res.json();\n};\n\nexport const loginUser = async ({ username, password }) => {\n    const response = await fetch('http://localhost:5000/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    });\n    const data = await response.json();\n    if (data.token) {\n        setToken(data.token);\n        return await getCurrentUser();\n    } else {\n        throw new Error(data.message || 'Login failed');\n    }\n};\n\nexport const registerUser = async ({ username, password, role }) => {\n    const response = await fetch('http://localhost:5000/api/auth/register', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password, role })\n    });\n    const data = await response.json();\n    if (response.ok) {\n        return data;\n    } else {\n        throw new Error(data.message || 'Registration failed');\n    }\n};\n\nexport const logoutUser = () => {\n    removeToken();\n};"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AAEtC,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EAC/BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;AACxC,CAAC;AAED,OAAO,MAAMG,QAAQ,GAAGA,CAAA,KAAM;EAC1B,OAAOF,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;AACxC,CAAC;AAED,OAAO,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAC7BJ,YAAY,CAACK,UAAU,CAAC,OAAO,CAAC;AACpC,CAAC;AAED,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAM;EACjC,MAAMP,KAAK,GAAGG,QAAQ,CAAC,CAAC;EACxB,OAAOH,KAAK,KAAK,IAAI;AACzB,CAAC;AAED,OAAO,MAAMQ,cAAc,GAAG,MAAAA,CAAA,KAAY;EACtC,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,wCAAwC,EAAE;IAC9DC,MAAM,EAAE,KAAK;IACbC,WAAW,EAAE,SAAS,CAAE;EAC5B,CAAC,CAAC;EACF,IAAI,CAACH,GAAG,CAACI,EAAE,EAAE,OAAO,IAAI;EACxB,OAAO,MAAMJ,GAAG,CAACK,IAAI,CAAC,CAAC;AAC3B,CAAC;AAED,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAO;EAAEC,QAAQ;EAAEC;AAAS,CAAC,KAAK;EACvD,MAAMC,QAAQ,GAAG,MAAMR,KAAK,CAAC,sCAAsC,EAAE;IACjEC,MAAM,EAAE,MAAM;IACdQ,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEN,QAAQ;MAAEC;IAAS,CAAC;EAC/C,CAAC,CAAC;EACF,MAAMM,IAAI,GAAG,MAAML,QAAQ,CAACJ,IAAI,CAAC,CAAC;EAClC,IAAIS,IAAI,CAACvB,KAAK,EAAE;IACZD,QAAQ,CAACwB,IAAI,CAACvB,KAAK,CAAC;IACpB,OAAO,MAAMQ,cAAc,CAAC,CAAC;EACjC,CAAC,MAAM;IACH,MAAM,IAAIgB,KAAK,CAACD,IAAI,CAACE,OAAO,IAAI,cAAc,CAAC;EACnD;AACJ,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,MAAAA,CAAO;EAAEV,QAAQ;EAAEC,QAAQ;EAAEU;AAAK,CAAC,KAAK;EAChE,MAAMT,QAAQ,GAAG,MAAMR,KAAK,CAAC,yCAAyC,EAAE;IACpEC,MAAM,EAAE,MAAM;IACdQ,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEN,QAAQ;MAAEC,QAAQ;MAAEU;IAAK,CAAC;EACrD,CAAC,CAAC;EACF,MAAMJ,IAAI,GAAG,MAAML,QAAQ,CAACJ,IAAI,CAAC,CAAC;EAClC,IAAII,QAAQ,CAACL,EAAE,EAAE;IACb,OAAOU,IAAI;EACf,CAAC,MAAM;IACH,MAAM,IAAIC,KAAK,CAACD,IAAI,CAACE,OAAO,IAAI,qBAAqB,CAAC;EAC1D;AACJ,CAAC;AAED,OAAO,MAAMG,UAAU,GAAGA,CAAA,KAAM;EAC5BvB,WAAW,CAAC,CAAC;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}