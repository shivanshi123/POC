{"ast":null,"code":"import { jwtDecode } from 'jwt-decode';\nexport const setToken = token => {\n  localStorage.setItem('token', token);\n};\nexport const getToken = () => {\n  return localStorage.getItem('token');\n};\nexport const removeToken = () => {\n  localStorage.removeItem('token');\n};\nexport const isAuthenticated = () => {\n  const token = getToken();\n  return token !== null;\n};\nexport const getCurrentUser = async () => {\n  const token = getToken();\n  if (!token) return null;\n  try {\n    const decoded = jwtDecode(token);\n    return decoded;\n  } catch (err) {\n    return null;\n  }\n};\nexport const loginUser = async ({\n  username,\n  password\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/login', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  const data = await response.json();\n  if (data.token) {\n    setToken(data.token);\n    return await getCurrentUser();\n  } else {\n    throw new Error(data.message || 'Login failed');\n  }\n};\nexport const registerUser = async ({\n  username,\n  password,\n  role\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/register', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password,\n      role\n    })\n  });\n  const data = await response.json();\n  if (response.ok) {\n    return data;\n  } else {\n    throw new Error(data.message || 'Registration failed');\n  }\n};\nexport const logoutUser = () => {\n  removeToken();\n};","map":{"version":3,"names":["jwtDecode","setToken","token","localStorage","setItem","getToken","getItem","removeToken","removeItem","isAuthenticated","getCurrentUser","decoded","err","loginUser","username","password","response","fetch","method","headers","body","JSON","stringify","data","json","Error","message","registerUser","role","ok","logoutUser"],"sources":["C:/Users/Mansa Pandey/Desktop/SampleProject/unified-security-app/frontend/src/utils/authUtils.js"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\n\nexport const setToken = (token) => {\n    localStorage.setItem('token', token);\n};\n\nexport const getToken = () => {\n    return localStorage.getItem('token');\n};\n\nexport const removeToken = () => {\n    localStorage.removeItem('token');\n};\n\nexport const isAuthenticated = () => {\n    const token = getToken();\n    return token !== null;\n};\n\nexport const getCurrentUser = async () => {\n    const token = getToken();\n    if (!token) return null;\n    try {\n        const decoded = jwtDecode(token);\n        return decoded;\n    } catch (err) {\n        return null;\n    }\n};\n\nexport const loginUser = async ({ username, password }) => {\n    const response = await fetch('http://localhost:5000/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    });\n    const data = await response.json();\n    if (data.token) {\n        setToken(data.token);\n        return await getCurrentUser();\n    } else {\n        throw new Error(data.message || 'Login failed');\n    }\n};\n\nexport const registerUser = async ({ username, password, role }) => {\n    const response = await fetch('http://localhost:5000/api/auth/register', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password, role })\n    });\n    const data = await response.json();\n    if (response.ok) {\n        return data;\n    } else {\n        throw new Error(data.message || 'Registration failed');\n    }\n};\n\nexport const logoutUser = () => {\n    removeToken();\n};"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AAEtC,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EAC/BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;AACxC,CAAC;AAED,OAAO,MAAMG,QAAQ,GAAGA,CAAA,KAAM;EAC1B,OAAOF,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;AACxC,CAAC;AAED,OAAO,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAC7BJ,YAAY,CAACK,UAAU,CAAC,OAAO,CAAC;AACpC,CAAC;AAED,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAM;EACjC,MAAMP,KAAK,GAAGG,QAAQ,CAAC,CAAC;EACxB,OAAOH,KAAK,KAAK,IAAI;AACzB,CAAC;AAED,OAAO,MAAMQ,cAAc,GAAG,MAAAA,CAAA,KAAY;EACtC,MAAMR,KAAK,GAAGG,QAAQ,CAAC,CAAC;EACxB,IAAI,CAACH,KAAK,EAAE,OAAO,IAAI;EACvB,IAAI;IACA,MAAMS,OAAO,GAAGX,SAAS,CAACE,KAAK,CAAC;IAChC,OAAOS,OAAO;EAClB,CAAC,CAAC,OAAOC,GAAG,EAAE;IACV,OAAO,IAAI;EACf;AACJ,CAAC;AAED,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAO;EAAEC,QAAQ;EAAEC;AAAS,CAAC,KAAK;EACvD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,sCAAsC,EAAE;IACjEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAER,QAAQ;MAAEC;IAAS,CAAC;EAC/C,CAAC,CAAC;EACF,MAAMQ,IAAI,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;EAClC,IAAID,IAAI,CAACrB,KAAK,EAAE;IACZD,QAAQ,CAACsB,IAAI,CAACrB,KAAK,CAAC;IACpB,OAAO,MAAMQ,cAAc,CAAC,CAAC;EACjC,CAAC,MAAM;IACH,MAAM,IAAIe,KAAK,CAACF,IAAI,CAACG,OAAO,IAAI,cAAc,CAAC;EACnD;AACJ,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,MAAAA,CAAO;EAAEb,QAAQ;EAAEC,QAAQ;EAAEa;AAAK,CAAC,KAAK;EAChE,MAAMZ,QAAQ,GAAG,MAAMC,KAAK,CAAC,yCAAyC,EAAE;IACpEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAER,QAAQ;MAAEC,QAAQ;MAAEa;IAAK,CAAC;EACrD,CAAC,CAAC;EACF,MAAML,IAAI,GAAG,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;EAClC,IAAIR,QAAQ,CAACa,EAAE,EAAE;IACb,OAAON,IAAI;EACf,CAAC,MAAM;IACH,MAAM,IAAIE,KAAK,CAACF,IAAI,CAACG,OAAO,IAAI,qBAAqB,CAAC;EAC1D;AACJ,CAAC;AAED,OAAO,MAAMI,UAAU,GAAGA,CAAA,KAAM;EAC5BvB,WAAW,CAAC,CAAC;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}