{"ast":null,"code":"import { jwtDecode } from 'jwt-decode';\nexport const setToken = token => {\n  localStorage.setItem('token', token);\n};\nexport const getToken = () => {\n  return localStorage.getItem('token');\n};\nexport const removeToken = () => {\n  localStorage.removeItem('token');\n};\nexport function isAuthenticated() {\n  return !!localStorage.getItem('jwt');\n}\nexport async function getCurrentUser() {\n  const token = localStorage.getItem('jwt');\n  const res = await fetch('http://localhost:5000/api/auth/current', {\n    method: 'GET',\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  if (!res.ok) return null;\n  return await res.json();\n}\nexport const loginUser = async ({\n  username,\n  password\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/login', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  const data = await response.json();\n  if (data.token) {\n    setToken(data.token);\n    return await getCurrentUser();\n  } else {\n    throw new Error(data.message || 'Login failed');\n  }\n};\nexport const registerUser = async ({\n  username,\n  password,\n  role\n}) => {\n  const response = await fetch('http://localhost:5000/api/auth/register', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password,\n      role\n    })\n  });\n  const data = await response.json();\n  if (response.ok) {\n    return data;\n  } else {\n    throw new Error(data.message || 'Registration failed');\n  }\n};\nexport const logoutUser = () => {\n  removeToken();\n};","map":{"version":3,"names":["jwtDecode","setToken","token","localStorage","setItem","getToken","getItem","removeToken","removeItem","isAuthenticated","getCurrentUser","res","fetch","method","headers","Authorization","ok","json","loginUser","username","password","response","body","JSON","stringify","data","Error","message","registerUser","role","logoutUser"],"sources":["C:/Users/Mansa Pandey/Desktop/SampleProject/unified-security-app/frontend/src/utils/authUtils.js"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\n\nexport const setToken = (token) => {\n    localStorage.setItem('token', token);\n};\n\nexport const getToken = () => {\n    return localStorage.getItem('token');\n};\n\nexport const removeToken = () => {\n    localStorage.removeItem('token');\n};\n\nexport function isAuthenticated() {\n  return !!localStorage.getItem('jwt');\n}\n\nexport async function getCurrentUser() {\n  const token = localStorage.getItem('jwt');\n  const res = await fetch('http://localhost:5000/api/auth/current', {\n    method: 'GET',\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  });\n  if (!res.ok) return null;\n  return await res.json();\n}\n\nexport const loginUser = async ({ username, password }) => {\n    const response = await fetch('http://localhost:5000/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n    });\n    const data = await response.json();\n    if (data.token) {\n        setToken(data.token);\n        return await getCurrentUser();\n    } else {\n        throw new Error(data.message || 'Login failed');\n    }\n};\n\nexport const registerUser = async ({ username, password, role }) => {\n    const response = await fetch('http://localhost:5000/api/auth/register', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password, role })\n    });\n    const data = await response.json();\n    if (response.ok) {\n        return data;\n    } else {\n        throw new Error(data.message || 'Registration failed');\n    }\n};\n\nexport const logoutUser = () => {\n    removeToken();\n};"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AAEtC,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EAC/BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;AACxC,CAAC;AAED,OAAO,MAAMG,QAAQ,GAAGA,CAAA,KAAM;EAC1B,OAAOF,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;AACxC,CAAC;AAED,OAAO,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAC7BJ,YAAY,CAACK,UAAU,CAAC,OAAO,CAAC;AACpC,CAAC;AAED,OAAO,SAASC,eAAeA,CAAA,EAAG;EAChC,OAAO,CAAC,CAACN,YAAY,CAACG,OAAO,CAAC,KAAK,CAAC;AACtC;AAEA,OAAO,eAAeI,cAAcA,CAAA,EAAG;EACrC,MAAMR,KAAK,GAAGC,YAAY,CAACG,OAAO,CAAC,KAAK,CAAC;EACzC,MAAMK,GAAG,GAAG,MAAMC,KAAK,CAAC,wCAAwC,EAAE;IAChEC,MAAM,EAAE,KAAK;IACbC,OAAO,EAAE;MACPC,aAAa,EAAE,UAAUb,KAAK;IAChC;EACF,CAAC,CAAC;EACF,IAAI,CAACS,GAAG,CAACK,EAAE,EAAE,OAAO,IAAI;EACxB,OAAO,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;AACzB;AAEA,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAO;EAAEC,QAAQ;EAAEC;AAAS,CAAC,KAAK;EACvD,MAAMC,QAAQ,GAAG,MAAMT,KAAK,CAAC,sCAAsC,EAAE;IACjEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEL,QAAQ;MAAEC;IAAS,CAAC;EAC/C,CAAC,CAAC;EACF,MAAMK,IAAI,GAAG,MAAMJ,QAAQ,CAACJ,IAAI,CAAC,CAAC;EAClC,IAAIQ,IAAI,CAACvB,KAAK,EAAE;IACZD,QAAQ,CAACwB,IAAI,CAACvB,KAAK,CAAC;IACpB,OAAO,MAAMQ,cAAc,CAAC,CAAC;EACjC,CAAC,MAAM;IACH,MAAM,IAAIgB,KAAK,CAACD,IAAI,CAACE,OAAO,IAAI,cAAc,CAAC;EACnD;AACJ,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,MAAAA,CAAO;EAAET,QAAQ;EAAEC,QAAQ;EAAES;AAAK,CAAC,KAAK;EAChE,MAAMR,QAAQ,GAAG,MAAMT,KAAK,CAAC,yCAAyC,EAAE;IACpEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEL,QAAQ;MAAEC,QAAQ;MAAES;IAAK,CAAC;EACrD,CAAC,CAAC;EACF,MAAMJ,IAAI,GAAG,MAAMJ,QAAQ,CAACJ,IAAI,CAAC,CAAC;EAClC,IAAII,QAAQ,CAACL,EAAE,EAAE;IACb,OAAOS,IAAI;EACf,CAAC,MAAM;IACH,MAAM,IAAIC,KAAK,CAACD,IAAI,CAACE,OAAO,IAAI,qBAAqB,CAAC;EAC1D;AACJ,CAAC;AAED,OAAO,MAAMG,UAAU,GAAGA,CAAA,KAAM;EAC5BvB,WAAW,CAAC,CAAC;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}